# 1.setup: 所有组合式 API 表演的舞台
```javascript
setup(props, context){}
```
- setup 是 Vue3 的钩子函数, 是使用 组合式API 的入口;
- setup 执行时机: beforeCreate 之前执行一次;
- setup 中 this 是 undefined;
- setup 不能是 async 函数;
- 接收两个参数: props, context;
- 返回值: 对象、函数(即: 渲染函数);

### 接收两个参数
#### props 参数
- 在 props 中声明过的 props 属性;

#### context 参数
- 对象, 包含 attrs, emit, slots, expose 属性;
- context.attrs: 等价于 Vue2 的 $attrs;
- context.emit: 触发自定义的事件, 等价于 $emit;
- context.slots: 插槽, 等价于 $slots;

#### setup() 的返回值
- 若返回对象, 则对象的属性、方法, 均可在模板和组件实例中使用;
- 若返回一个函数(渲染函数), 则可自定义渲染内容;
```html
// 渲染结果: 展示 张三、按钮
<template>
  <h2>name: {{name}}</h2>
  <button @click="say">say</button>
</template>

<script>
  export default {
    name: 'App',
    setup() {
      let name = 'zhangSan';
      function say() {
        console.info(name);
      }
      return {
        name,
        say,
      }
    }
  }
</script>
```
```html
// 渲染结果: 展示 <h1>66</h1>
<template>
  <h2>name: {{name}}</h2>
  <button @click="say">say</button>
</template>

<script>
  import {h} from 'vue';
  export default {
    name: 'App',
    setup() {
      let name = 'zhangSan';
      function say() {
        console.info(name);
      }
      return () => h('h1', '66')
    }
  }
</script>
```

### ref(): 定义响应式数据(基本数据类型 + 对象类型)
- 主要定义 基本数据类型的响应式数据, 也可以定义 对象类型;
- RefImpl(Reference implement): 引用实现对象;
- 通过 ref() 创建一个引用对象, 通过该对象实现响应式;
- .value: 通过 .value 属性修改响应式的值;
- 对于基本类型的数据, 通过 get、set 数据劫持;
- 对于对象类型的数据, 通过 proxy 劫持;
- <template> 中展示响应式值时不需要增加 .value, vue 解析时自动增加;

### reactive(): 定义响应式数据(对象类型)
- 定义对象类型的响应式数据;
- 接收一个对象/数组, 返回一个代理对象(Proxy 的实例对象);
- 和 ref() 定义的响应式对象不同点: 修改和获取值时无需增加 .value;

### 不要和 Vue2 的配置混用
- Vue2配置(data, methods, computed...) 可以通过 this.XX 访问到 setup 中返回对象的属性和方法;
- setup 中不能访问到 Vue2 的配置(data, methods, computed...);
- 命名有冲突时, setup 优先;
