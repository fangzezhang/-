# 5.传输层+应用层
## 传输层
- TCP 协议
- UDP 协议
- 报文首部包含 源IP地址、目的IP地址, 源端口、目的端口;

### TCP协议
- 数据分段、编号;
- 可靠传输(丢包重传);
- 流量控制;
- 避免网络拥塞;
- 建立会话, 每条 TCP连接只能有两个端点, 每条 TCP连接只能点对点(一对一);
- eg: 上网、视频传输;

#### 报文段首部(20个字节)
- 源端口、目标端口;
- 序号: 本数据段的第一个字节是整个文件的第几个字节;
- 确认号: 对方下一个数据包应该发送第几个字节的数据包;
- 数据偏移: 数据是从包的哪里开始;

#### 可靠传输
##### 停止等待协议
- TCP 发送一个包后就停止, 等待确认, 确认后再发送第二个包;
- 重传是自动进行的, 发送方只要没有收到确认就会重传;
- 缺点: 信道利用率太低;
##### 流水线传输
- 不再每发一个包就等待确认, 而是一次性发送5个包;
- 维持一个滑动窗口, 一个包确认完毕后, 窗口向后滑动一位;

### UDP协议
- 不建立会话, 一个数据包就能完成数据通信;
- eg: QQ聊天、计算机上课时的多播、DNS 解析;

## 应用层
### 传输层和应用层之间的关系: TCP/UDP + 一个端口
- HTTP协议 = TCP协议 + 80端口;
- HTTPS协议 = TCP协议 + 443端口;
- ftp协议 = TCP协议 + 21端口;
- SMTP协议(发电子邮件) = TCP协议 + 25端口;
- POP3协议(收电子邮件) = TCP协议 + 110端口;
- RDP协议(远程桌面) = TCP协议 + 3389端口;
- 共享文件夹 = TCP协议 + 45端口;
- SQL = TCP协议 + 1433端口;
- DNS = UDP协议 + 53端口 或者 TCP协议 + 53端口;

### 应用层和外部服务之间的关系
- 服务运行后在 TCP 或 UDP 的某个端口监听客户端请求;
- 通过 IP 定位计算机;
- 通过端口定位服务;
- 端口代表服务;